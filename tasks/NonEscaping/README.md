NonEscaping
===========
> Юный хакер Вася разрабатывает свой сервис для получения лицензионных ключей. Бета-версию нельзя найти в Google, но Вася поделился с нами прямой ссылкой: licensekey.contest.qctf.ru

Flag
----
QCTF_885fae565c86d81fb3beb4bba39833ba

Описание
--------
Цель таска - проэксплуатировать SQL-инъекцию в SELECT запросе на уязвимом сайте. Несмотря на обработку всех входных параметров с помощью функции real_escape_string, инъекция возможна благодаря обрезке серийного номера до фиксированной длины, которая выполняется уже после обработки.

Эксплуатация
------------
SQL-запрос выглядит следующим образом:
```
$query = "SELECT * FROM users WHERE serial='$serial' AND username='$username'";
```
В запросе используются два поля, полученных от пользователя: serial и username, причём именно в таком порядке. После экранирования поле serial обрезается до 19 символов. Это позволяет, сформировав его специальным образом, нарушить структуру запроса: экранировать кавычку перед AND и в поле username подставить новое продолжение SQL запроса.
Нужно подставить такой серийный номер, чтобы после его обработки функцией real_escape_string 19-м символом шёл символ '\'. Т.к. каждая одинарная кавычка после экранирования переходит в два символа, достаточно послать строку из 10 или более кавычек. В поле username можно подставить строку " OR 1=1 -- ", что позволит получить license_key для первой строки таблицы users.
Итоговый запрос будет выглядеть так:
```
SELECT * FROM users WHERE serial='\'\'...\'\' AND username=' OR 1=1 -- '
```